const {inspect} = require('util')
const {treeBuilder, ArrayNode, traverseTreeUpDown, traverseTreeDownUp, ScalarNode, PropertyNode} = require('./json-tree')
const {treeRenderer} = require('./json-tree-renderer')

const json = `{"usd":{"code":"USD","alphaCode":"USD","numericCode":"840","name":"U.S. Dollar","rate":0.041154310887648,"date":"Sun, 20 May 2018 12:00:01 GMT"},"eur":{"code":"EUR","alphaCode":"EUR","numericCode":"978","name":"Euro","rate":0.034908933408201,"date":"Sun, 20 May 2018 12:00:01 GMT"},"gbp":{"code":"GBP","alphaCode":"GBP","numericCode":"826","name":"U.K. Pound Sterling","rate":0.030497395037401,"date":"Sun, 20 May 2018 12:00:01 GMT"},"jpy":{"code":"JPY","alphaCode":"JPY","numericCode":"392","name":"Japanese Yen","rate":4.5633202922331,"date":"Sun, 20 May 2018 12:00:01 GMT"},"chf":{"code":"CHF","alphaCode":"CHF","numericCode":"756","name":"Swiss Franc","rate":0.041128846181423,"date":"Sun, 20 May 2018 12:00:01 GMT"},"aud":{"code":"AUD","alphaCode":"AUD","numericCode":"036","name":"Australian Dollar","rate":0.054761102146304,"date":"Sun, 20 May 2018 12:00:01 GMT"},"cad":{"code":"CAD","alphaCode":"CAD","numericCode":"124","name":"Canadian Dollar","rate":0.05275716335488,"date":"Sun, 20 May 2018 12:00:01 GMT"},"sll":{"code":"SLL","alphaCode":"SLL","numericCode":"694","name":"Sierra Leonean leone","rate":325.52165253197,"date":"Sun, 20 May 2018 12:00:01 GMT"},"scr":{"code":"SCR","alphaCode":"SCR","numericCode":"690","name":"Seychelles rupee","rate":0.55644726928541,"date":"Sun, 20 May 2018 12:00:01 GMT"},"czk":{"code":"CZK","alphaCode":"CZK","numericCode":"203","name":"Czech Koruna","rate":0.89375234471036,"date":"Sun, 20 May 2018 12:00:01 GMT"},"pln":{"code":"PLN","alphaCode":"PLN","numericCode":"985","name":"Polish Zloty","rate":0.14993481629203,"date":"Sun, 20 May 2018 12:00:01 GMT"},"ron":{"code":"RON","alphaCode":"RON","numericCode":"946","name":"Romanian New Leu","rate":0.16179889657974,"date":"Sun, 20 May 2018 12:00:01 GMT"},"azn":{"code":"AZN","alphaCode":"AZN","numericCode":"944","name":"Azerbaijan Manat","rate":0.070196986898698,"date":"Sun, 20 May 2018 12:00:01 GMT"},"bob":{"code":"BOB","alphaCode":"BOB","numericCode":"068","name":"Bolivian Boliviano","rate":0.28456089538955,"date":"Sun, 20 May 2018 12:00:01 GMT"},"gyd":{"code":"GYD","alphaCode":"GYD","numericCode":"328","name":"Guyanese dollar","rate":8.642999143706,"date":"Sun, 20 May 2018 12:00:01 GMT"},"rwf":{"code":"RWF","alphaCode":"RWF","numericCode":"646","name":"Rwandan franc","rate":35.943341374148,"date":"Sun, 20 May 2018 12:00:01 GMT"},"mzn":{"code":"MZN","alphaCode":"MZN","numericCode":"943","name":"Mozambican metical","rate":2.4832497539753,"date":"Sun, 20 May 2018 12:00:01 GMT"},"tzs":{"code":"TZS","alphaCode":"TZS","numericCode":"834","name":"Tanzanian shilling","rate":94.354102183178,"date":"Sun, 20 May 2018 12:00:01 GMT"},"isk":{"code":"ISK","alphaCode":"ISK","numericCode":"352","name":"Icelandic Krona","rate":4.3096314573608,"date":"Sun, 20 May 2018 12:00:01 GMT"},"sgd":{"code":"SGD","alphaCode":"SGD","numericCode":"702","name":"Singapore Dollar","rate":0.055276477251105,"date":"Sun, 20 May 2018 12:00:01 GMT"},"hkd":{"code":"HKD","alphaCode":"HKD","numericCode":"344","name":"Hong Kong Dollar","rate":0.32305587393343,"date":"Sun, 20 May 2018 12:00:01 GMT"},"mdl":{"code":"MDL","alphaCode":"MDL","numericCode":"498","name":"Moldova Lei","rate":0.68625527669224,"date":"Sun, 20 May 2018 12:00:01 GMT"},"afn":{"code":"AFN","alphaCode":"AFN","numericCode":"971","name":"Afghan afghani","rate":2.9343515611347,"date":"Sun, 20 May 2018 12:00:01 GMT"},"nad":{"code":"NAD","alphaCode":"NAD","numericCode":"516","name":"Namibian dollar","rate":0.51831069631259,"date":"Sun, 20 May 2018 12:00:01 GMT"},"sdg":{"code":"SDG","alphaCode":"SDG","numericCode":"938","name":"Sudanese pound","rate":0.74720539004342,"date":"Sun, 20 May 2018 12:00:01 GMT"},"top":{"code":"TOP","alphaCode":"TOP","numericCode":"776","name":"Tongan pa\u02bbanga","rate":0.091115954828224,"date":"Sun, 20 May 2018 12:00:01 GMT"},"mnt":{"code":"MNT","alphaCode":"MNT","numericCode":"496","name":"Mongolian togrog","rate":99.362946360124,"date":"Sun, 20 May 2018 12:00:01 GMT"},"kzt":{"code":"KZT","alphaCode":"KZT","numericCode":"398","name":"Kazakhstani Tenge","rate":13.517122530609,"date":"Sun, 20 May 2018 12:00:01 GMT"},"php":{"code":"PHP","alphaCode":"PHP","numericCode":"608","name":"Philippine Peso","rate":2.156690234327,"date":"Sun, 20 May 2018 12:00:01 GMT"},"uzs":{"code":"UZS","alphaCode":"UZS","numericCode":"860","name":"Uzbekistan Sum","rate":331.15696739464,"date":"Sun, 20 May 2018 12:00:01 GMT"},"etb":{"code":"ETB","alphaCode":"ETB","numericCode":"230","name":"Ethiopian birr","rate":1.1378416425889,"date":"Sun, 20 May 2018 12:00:01 GMT"},"xcd":{"code":"XCD","alphaCode":"XCD","numericCode":"951","name":"East Caribbean Dollar","rate":0.11206403245375,"date":"Sun, 20 May 2018 12:00:01 GMT"},"htg":{"code":"HTG","alphaCode":"HTG","numericCode":"332","name":"Haitian gourde","rate":2.6691615002621,"date":"Sun, 20 May 2018 12:00:01 GMT"},"gtq":{"code":"GTQ","alphaCode":"GTQ","numericCode":"320","name":"Guatemalan Quetzal","rate":0.30715889264555,"date":"Sun, 20 May 2018 12:00:01 GMT"},"lyd":{"code":"LYD","alphaCode":"LYD","numericCode":"434","name":"Libyan Dinar","rate":0.031416337825474,"date":"Sun, 20 May 2018 12:00:01 GMT"},"aed":{"code":"AED","alphaCode":"AED","numericCode":"784","name":"U.A.E Dirham","rate":0.15117842392899,"date":"Sun, 20 May 2018 12:00:01 GMT"},"twd":{"code":"TWD","alphaCode":"TWD","numericCode":"901","name":"New Taiwan Dollar ","rate":1.2324613261777,"date":"Sun, 20 May 2018 12:00:01 GMT"},"irr":{"code":"IRR","alphaCode":"IRR","numericCode":"364","name":"Iranian rial","rate":1729.5595667591,"date":"Sun, 20 May 2018 12:00:01 GMT"},"mkd":{"code":"MKD","alphaCode":"MKD","numericCode":"807","name":"Macedonian denar","rate":2.1469633689111,"date":"Sun, 20 May 2018 12:00:01 GMT"},"awg":{"code":"AWG","alphaCode":"AWG","numericCode":"533","name":"Aruban florin","rate":0.073625705656753,"date":"Sun, 20 May 2018 12:00:01 GMT"},"mwk":{"code":"MWK","alphaCode":"MWK","numericCode":"454","name":"Malawian kwacha","rate":29.977970002944,"date":"Sun, 20 May 2018 12:00:01 GMT"},"mmk":{"code":"MMK","alphaCode":"MMK","numericCode":"104","name":"Myanma Kyat","rate":55.706830418418,"date":"Sun, 20 May 2018 12:00:01 GMT"},"omr":{"code":"OMR","alphaCode":"OMR","numericCode":"512","name":"Omani Rial","rate":0.016582314721288,"date":"Sun, 20 May 2018 12:00:01 GMT"},"bnd":{"code":"BND","alphaCode":"BND","numericCode":"096","name":"Brunei Dollar","rate":0.055269131981975,"date":"Sun, 20 May 2018 12:00:01 GMT"},"npr":{"code":"NPR","alphaCode":"NPR","numericCode":"524","name":"Nepalese Rupee","rate":4.4610188598024,"date":"Sun, 20 May 2018 12:00:01 GMT"},"brl":{"code":"BRL","alphaCode":"BRL","numericCode":"986","name":"Brazilian Real","rate":0.15338800213644,"date":"Sun, 20 May 2018 12:00:01 GMT"},"ngn":{"code":"NGN","alphaCode":"NGN","numericCode":"566","name":"Nigerian Naira","rate":12.793667465411,"date":"Sun, 20 May 2018 12:00:01 GMT"},"lbp":{"code":"LBP","alphaCode":"LBP","numericCode":"422","name":"Lebanese Pound","rate":62.448011878858,"date":"Sun, 20 May 2018 12:00:01 GMT"},"stn":{"code":"STN","alphaCode":"STN","numericCode":"930","name":"S\u00e3o Tom\u00e9 and Pr\u00edncipe Dobra","rate":0.86156478805929,"date":"Sun, 20 May 2018 12:00:01 GMT"},"djf":{"code":"DJF","alphaCode":"DJF","numericCode":"262","name":"Djiboutian franc","rate":7.356421526146,"date":"Sun, 20 May 2018 12:00:01 GMT"},"hnl":{"code":"HNL","alphaCode":"HNL","numericCode":"340","name":"Honduran Lempira","rate":0.98319080869798,"date":"Sun, 20 May 2018 12:00:01 GMT"},"mvr":{"code":"MVR","alphaCode":"MVR","numericCode":"462","name":"Maldivian rufiyaa","rate":0.63936789139497,"date":"Sun, 20 May 2018 12:00:01 GMT"},"cop":{"code":"COP","alphaCode":"COP","numericCode":"170","name":"Colombian Peso","rate":118.90660513028,"date":"Sun, 20 May 2018 12:00:01 GMT"},"pkr":{"code":"PKR","alphaCode":"PKR","numericCode":"586","name":"Pakistani Rupee","rate":4.7606790050865,"date":"Sun, 20 May 2018 12:00:01 GMT"},"bgn":{"code":"BGN","alphaCode":"BGN","numericCode":"975","name":"Bulgarian Lev","rate":0.06831081157178,"date":"Sun, 20 May 2018 12:00:01 GMT"},"bdt":{"code":"BDT","alphaCode":"BDT","numericCode":"050","name":"Bangladeshi taka","rate":3.4924303707117,"date":"Sun, 20 May 2018 12:00:01 GMT"},"uyu":{"code":"UYU","alphaCode":"UYU","numericCode":"858","name":"Uruguayan Peso","rate":1.2775861086692,"date":"Sun, 20 May 2018 12:00:01 GMT"},"fjd":{"code":"FJD","alphaCode":"FJD","numericCode":"242","name":"Fiji Dollar","rate":0.085894544923252,"date":"Sun, 20 May 2018 12:00:01 GMT"},"cdf":{"code":"CDF","alphaCode":"CDF","numericCode":"976","name":"Congolese franc","rate":66.491989415943,"date":"Sun, 20 May 2018 12:00:01 GMT"},"lsl":{"code":"LSL","alphaCode":"LSL","numericCode":"426","name":"Lesotho loti","rate":0.51813135005089,"date":"Sun, 20 May 2018 12:00:01 GMT"},"sos":{"code":"SOS","alphaCode":"SOS","numericCode":"706","name":"Somali shilling","rate":23.923943148219,"date":"Sun, 20 May 2018 12:00:01 GMT"},"huf":{"code":"HUF","alphaCode":"HUF","numericCode":"348","name":"Hungarian Forint","rate":11.085053218142,"date":"Sun, 20 May 2018 12:00:01 GMT"},"rub":{"code":"RUB","alphaCode":"RUB","numericCode":"643","name":"Russian Rouble","rate":2.5555500772763,"date":"Sun, 20 May 2018 12:00:01 GMT"},"try":{"code":"TRY","alphaCode":"TRY","numericCode":"949","name":"Turkish Lira","rate":0.18433791526908,"date":"Sun, 20 May 2018 12:00:01 GMT"},"kgs":{"code":"KGS","alphaCode":"KGS","numericCode":"417","name":"Kyrgyzstan Som","rate":2.8248470788827,"date":"Sun, 20 May 2018 12:00:01 GMT"},"nio":{"code":"NIO","alphaCode":"NIO","numericCode":"558","name":"Nicaraguan C\u00f3rdoba","rate":1.2937838026548,"date":"Sun, 20 May 2018 12:00:01 GMT"},"lrd":{"code":"LRD","alphaCode":"LRD","numericCode":"430","name":"Liberian dollar","rate":5.5665412700635,"date":"Sun, 20 May 2018 12:00:01 GMT"},"ssp":{"code":"SSP","alphaCode":"SSP","numericCode":"728","name":"South Sudanese pound","rate":5.5522993127186,"date":"Sun, 20 May 2018 12:00:01 GMT"},"mru":{"code":"MRU","alphaCode":"MRU","numericCode":"929","name":"Mauritanian ouguiya","rate":1.4709229878655,"date":"Sun, 20 May 2018 12:00:01 GMT"},"wst":{"code":"WST","alphaCode":"WST","numericCode":"882","name":"Samoan tala","rate":0.10490399338987,"date":"Sun, 20 May 2018 12:00:01 GMT"},"idr":{"code":"IDR","alphaCode":"IDR","numericCode":"360","name":"Indonesian Rupiah","rate":581.9637309387,"date":"Sun, 20 May 2018 12:00:01 GMT"},"sek":{"code":"SEK","alphaCode":"SEK","numericCode":"752","name":"Swedish Krona","rate":0.35980837058582,"date":"Sun, 20 May 2018 12:00:01 GMT"},"mxn":{"code":"MXN","alphaCode":"MXN","numericCode":"484","name":"Mexican Peso","rate":0.81561023994514,"date":"Sun, 20 May 2018 12:00:01 GMT"},"tjs":{"code":"TJS","alphaCode":"TJS","numericCode":"972","name":"Tajikistan Ruble","rate":0.37030742467478,"date":"Sun, 20 May 2018 12:00:01 GMT"},"pab":{"code":"PAB","alphaCode":"PAB","numericCode":"590","name":"Panamanian Balboa","rate":0.041317833438566,"date":"Sun, 20 May 2018 12:00:01 GMT"},"ttd":{"code":"TTD","alphaCode":"TTD","numericCode":"780","name":"Trinidad Tobago Dollar","rate":0.278741549078,"date":"Sun, 20 May 2018 12:00:01 GMT"},"ghs":{"code":"GHS","alphaCode":"GHS","numericCode":"936","name":"Ghanaian Cedi","rate":0.18776170553568,"date":"Sun, 20 May 2018 12:00:01 GMT"},"cup":{"code":"CUP","alphaCode":"CUP","numericCode":"192","name":"Cuban peso","rate":0.041317833438566,"date":"Sun, 20 May 2018 12:00:01 GMT"},"bam":{"code":"BAM","alphaCode":"BAM","numericCode":"977","name":"Bosnia and Herzegovina convertible mark","rate":0.068277762147054,"date":"Sun, 20 May 2018 12:00:01 GMT"},"dzd":{"code":"DZD","alphaCode":"DZD","numericCode":"012","name":"Algerian Dinar","rate":4.7831244005425,"date":"Sun, 20 May 2018 12:00:01 GMT"},"kwd":{"code":"KWD","alphaCode":"KWD","numericCode":"414","name":"Kuwaiti Dinar","rate":0.012474124069986,"date":"Sun, 20 May 2018 12:00:01 GMT"},"tnd":{"code":"TND","alphaCode":"TND","numericCode":"788","name":"Tunisian Dinar","rate":0.10356503667425,"date":"Sun, 20 May 2018 12:00:01 GMT"},"xof":{"code":"XOF","alphaCode":"XOF","numericCode":"952","name":"West African CFA Franc","rate":22.985533054195,"date":"Sun, 20 May 2018 12:00:01 GMT"},"egp":{"code":"EGP","alphaCode":"EGP","numericCode":"818","name":"Egyptian Pound","rate":0.73402473250543,"date":"Sun, 20 May 2018 12:00:01 GMT"},"gmd":{"code":"GMD","alphaCode":"GMD","numericCode":"270","name":"Gambian dalasi","rate":1.9754612158932,"date":"Sun, 20 May 2018 12:00:01 GMT"},"cve":{"code":"CVE","alphaCode":"CVE","numericCode":"132","name":"Cape Verde escudo","rate":3.8692496166591,"date":"Sun, 20 May 2018 12:00:01 GMT"},"lak":{"code":"LAK","alphaCode":"LAK","numericCode":"418","name":"Lao kip","rate":344.22979348207,"date":"Sun, 20 May 2018 12:00:01 GMT"},"aoa":{"code":"AOA","alphaCode":"AOA","numericCode":"973","name":"Angolan kwanza","rate":9.4772126686522,"date":"Sun, 20 May 2018 12:00:01 GMT"},"qar":{"code":"QAR","alphaCode":"QAR","numericCode":"634","name":"Qatari Rial","rate":0.15116087236494,"date":"Sun, 20 May 2018 12:00:01 GMT"},"bwp":{"code":"BWP","alphaCode":"BWP","numericCode":"072","name":"Botswana Pula","rate":0.41225691430099,"date":"Sun, 20 May 2018 12:00:01 GMT"},"mur":{"code":"MUR","alphaCode":"MUR","numericCode":"480","name":"Mauritian Rupee","rate":1.4194419156347,"date":"Sun, 20 May 2018 12:00:01 GMT"},"bbd":{"code":"BBD","alphaCode":"BBD","numericCode":"052","name":"Barbadian Dollar","rate":0.082351435048827,"date":"Sun, 20 May 2018 12:00:01 GMT"},"pgk":{"code":"PGK","alphaCode":"PGK","numericCode":"598","name":"Papua New Guinean kina","rate":0.13434100008976,"date":"Sun, 20 May 2018 12:00:01 GMT"},"jod":{"code":"JOD","alphaCode":"JOD","numericCode":"400","name":"Jordanian Dinar","rate":0.029269494732772,"date":"Sun, 20 May 2018 12:00:01 GMT"},"mad":{"code":"MAD","alphaCode":"MAD","numericCode":"504","name":"Moroccan Dirham","rate":0.38913711061514,"date":"Sun, 20 May 2018 12:00:01 GMT"},"xpf":{"code":"XPF","alphaCode":"XPF","numericCode":"953","name":"CFP Franc","rate":4.1658077664404,"date":"Sun, 20 May 2018 12:00:01 GMT"},"all":{"code":"ALL","alphaCode":"ALL","numericCode":"008","name":"Albanian lek","rate":4.4431904146674,"date":"Sun, 20 May 2018 12:00:01 GMT"},"lkr":{"code":"LKR","alphaCode":"LKR","numericCode":"144","name":"Sri Lanka Rupee","rate":6.5614986269097,"date":"Sun, 20 May 2018 12:00:01 GMT"},"clp":{"code":"CLP","alphaCode":"CLP","numericCode":"152","name":"Chilean Peso","rate":26.041168997527,"date":"Sun, 20 May 2018 12:00:01 GMT"},"nok":{"code":"NOK","alphaCode":"NOK","numericCode":"578","name":"Norwegian Krone","rate":0.33442912679432,"date":"Sun, 20 May 2018 12:00:01 GMT"},"dop":{"code":"DOP","alphaCode":"DOP","numericCode":"214","name":"Dominican Peso","rate":2.0404403176902,"date":"Sun, 20 May 2018 12:00:01 GMT"},"byn":{"code":"BYN","alphaCode":"BYN","numericCode":"933","name":"Belarussian Ruble","rate":0.082116787484677,"date":"Sun, 20 May 2018 12:00:01 GMT"},"pyg":{"code":"PYG","alphaCode":"PYG","numericCode":"600","name":"Paraguayan Guaran\u00ed","rate":231.60213505444,"date":"Sun, 20 May 2018 12:00:01 GMT"},"bzd":{"code":"BZD","alphaCode":"BZD","numericCode":"084","name":"Belize dollar","rate":0.083128829270361,"date":"Sun, 20 May 2018 12:00:01 GMT"},"kmf":{"code":"KMF","alphaCode":"KMF","numericCode":"174","name":"\\tComoro franc","rate":17.172013780356,"date":"Sun, 20 May 2018 12:00:01 GMT"},"szl":{"code":"SZL","alphaCode":"SZL","numericCode":"748","name":"Swazi lilangeni","rate":0.51813135005089,"date":"Sun, 20 May 2018 12:00:01 GMT"},"kes":{"code":"KES","alphaCode":"KES","numericCode":"404","name":"Kenyan shilling","rate":4.1565568401027,"date":"Sun, 20 May 2018 12:00:01 GMT"},"dkk":{"code":"DKK","alphaCode":"DKK","numericCode":"208","name":"Danish Krone","rate":0.26014546291778,"date":"Sun, 20 May 2018 12:00:01 GMT"},"sar":{"code":"SAR","alphaCode":"SAR","numericCode":"682","name":"Saudi Riyal","rate":0.15436070099655,"date":"Sun, 20 May 2018 12:00:01 GMT"},"hrk":{"code":"HRK","alphaCode":"HRK","numericCode":"191","name":"Croatian Kuna","rate":0.25791751170429,"date":"Sun, 20 May 2018 12:00:01 GMT"},"amd":{"code":"AMD","alphaCode":"AMD","numericCode":"051","name":"Armenia Dram","rate":19.950784920238,"date":"Sun, 20 May 2018 12:00:01 GMT"},"crc":{"code":"CRC","alphaCode":"CRC","numericCode":"188","name":"Costa Rican Col\u00f3n","rate":23.310534747926,"date":"Sun, 20 May 2018 12:00:01 GMT"},"jmd":{"code":"JMD","alphaCode":"JMD","numericCode":"388","name":"Jamaican Dollar","rate":5.1813135005089,"date":"Sun, 20 May 2018 12:00:01 GMT"},"gip":{"code":"GIP","alphaCode":"GIP","numericCode":"292","name":"Gibraltar pound","rate":0.030637332003009,"date":"Sun, 20 May 2018 12:00:01 GMT"},"ern":{"code":"ERN","alphaCode":"ERN","numericCode":"232","name":"Eritrean nakfa","rate":0.62339700318362,"date":"Sun, 20 May 2018 12:00:01 GMT"},"ugx":{"code":"UGX","alphaCode":"UGX","numericCode":"800","name":"Ugandan shilling","rate":153.89512863793,"date":"Sun, 20 May 2018 12:00:01 GMT"},"cny":{"code":"CNY","alphaCode":"CNY","numericCode":"156","name":"Chinese Yuan","rate":0.2623927013984,"date":"Sun, 20 May 2018 12:00:01 GMT"},"inr":{"code":"INR","alphaCode":"INR","numericCode":"356","name":"Indian Rupee","rate":2.797944927952,"date":"Sun, 20 May 2018 12:00:01 GMT"},"zar":{"code":"ZAR","alphaCode":"ZAR","numericCode":"710","name":"South African Rand","rate":0.52257629453965,"date":"Sun, 20 May 2018 12:00:01 GMT"},"ils":{"code":"ILS","alphaCode":"ILS","numericCode":"376","name":"Israeli New Sheqel","rate":0.14780387012296,"date":"Sun, 20 May 2018 12:00:01 GMT"},"tmt":{"code":"TMT","alphaCode":"TMT","numericCode":"934","name":"New Turkmenistan Manat","rate":0.14417846140686,"date":"Sun, 20 May 2018 12:00:01 GMT"},"mga":{"code":"MGA","alphaCode":"MGA","numericCode":"969","name":"Malagasy ariary","rate":134.17559154544,"date":"Sun, 20 May 2018 12:00:01 GMT"},"srd":{"code":"SRD","alphaCode":"SRD","numericCode":"968","name":"Surinamese dollar","rate":0.30918843725936,"date":"Sun, 20 May 2018 12:00:01 GMT"},"syp":{"code":"SYP","alphaCode":"SYP","numericCode":"760","name":"Syrian pound","rate":21.391422880672,"date":"Sun, 20 May 2018 12:00:01 GMT"},"mop":{"code":"MOP","alphaCode":"MOP","numericCode":"446","name":"Macanese pataca","rate":0.3343902638783,"date":"Sun, 20 May 2018 12:00:01 GMT"},"vuv":{"code":"VUV","alphaCode":"VUV","numericCode":"548","name":"Vanuatu vatu","rate":4.5566295467319,"date":"Sun, 20 May 2018 12:00:01 GMT"},"krw":{"code":"KRW","alphaCode":"KRW","numericCode":"410","name":"South Korean Won","rate":44.458970173401,"date":"Sun, 20 May 2018 12:00:01 GMT"},"thb":{"code":"THB","alphaCode":"THB","numericCode":"764","name":"Thai Baht","rate":1.3241076981844,"date":"Sun, 20 May 2018 12:00:01 GMT"},"xaf":{"code":"XAF","alphaCode":"XAF","numericCode":"950","name":"Central African CFA Franc","rate":23.029109897794,"date":"Sun, 20 May 2018 12:00:01 GMT"},"uah":{"code":"UAH","alphaCode":"UAH","numericCode":"980","name":"Ukrainian Hryvnia","rate":1.0762993563168,"date":"Sun, 20 May 2018 12:00:01 GMT"},"svc":{"code":"SVC","alphaCode":"SVC","numericCode":"222","name":"Salvadoran colon","rate":0.36204052264194,"date":"Sun, 20 May 2018 12:00:01 GMT"},"sbd":{"code":"SBD","alphaCode":"SBD","numericCode":"090","name":"Solomon Islands dollar","rate":0.31717847948465,"date":"Sun, 20 May 2018 12:00:01 GMT"},"ang":{"code":"ANG","alphaCode":"ANG","numericCode":"532","name":"Neth. Antillean Guilder","rate":0.074235268536367,"date":"Sun, 20 May 2018 12:00:01 GMT"},"zmw":{"code":"ZMW","alphaCode":"ZMW","numericCode":"967","name":"Zambian kwacha","rate":0.41250677731322,"date":"Sun, 20 May 2018 12:00:01 GMT"},"yer":{"code":"YER","alphaCode":"YER","numericCode":"886","name":"Yemeni rial","rate":10.34330041892,"date":"Sun, 20 May 2018 12:00:01 GMT"},"bhd":{"code":"BHD","alphaCode":"BHD","numericCode":"048","name":"Bahrain Dinar","rate":0.015493645447089,"date":"Sun, 20 May 2018 12:00:01 GMT"},"myr":{"code":"MYR","alphaCode":"MYR","numericCode":"458","name":"Malaysian Ringgit","rate":0.16355748062337,"date":"Sun, 20 May 2018 12:00:01 GMT"},"vef":{"code":"VEF","alphaCode":"VEF","numericCode":"937","name":"Venezuelan Bolivar","rate":2650.0681012751,"date":"Sun, 20 May 2018 12:00:01 GMT"},"vnd":{"code":"VND","alphaCode":"VND","numericCode":"704","name":"Vietnamese Dong","rate":934.13417614435,"date":"Sun, 20 May 2018 12:00:01 GMT"},"rsd":{"code":"RSD","alphaCode":"RSD","numericCode":"941","name":"Serbian Dinar","rate":4.1259186472444,"date":"Sun, 20 May 2018 12:00:01 GMT"},"iqd":{"code":"IQD","alphaCode":"IQD","numericCode":"368","name":"Iraqi dinar","rate":49.353975004848,"date":"Sun, 20 May 2018 12:00:01 GMT"},"bif":{"code":"BIF","alphaCode":"BIF","numericCode":"108","name":"Burundian franc","rate":72.866160664091,"date":"Sun, 20 May 2018 12:00:01 GMT"},"gel":{"code":"GEL","alphaCode":"GEL","numericCode":"981","name":"Georgian lari","rate":0.10050336275233,"date":"Sun, 20 May 2018 12:00:01 GMT"},"khr":{"code":"KHR","alphaCode":"KHR","numericCode":"116","name":"Cambodian riel","rate":168.43640063521,"date":"Sun, 20 May 2018 12:00:01 GMT"},"nzd":{"code":"NZD","alphaCode":"NZD","numericCode":"554","name":"New Zealand Dollar","rate":0.05961778321312,"date":"Sun, 20 May 2018 12:00:01 GMT"},"pen":{"code":"PEN","alphaCode":"PEN","numericCode":"604","name":"Peruvian Nuevo Sol","rate":0.13525327678054,"date":"Sun, 20 May 2018 12:00:01 GMT"},"bsd":{"code":"BSD","alphaCode":"BSD","numericCode":"044","name":"Bahamian Dollar","rate":0.041317833438566,"date":"Sun, 20 May 2018 12:00:01 GMT"},"gnf":{"code":"GNF","alphaCode":"GNF","numericCode":"324","name":"Guinean franc","rate":373.41635951298,"date":"Sun, 20 May 2018 12:00:01 GMT"}}`

const data = JSON.parse(json)

const tree = treeBuilder(data)
const query = 'Dollar'

traverseTreeUpDown(tree, (node, level, hasNextSibling) => {
    node.level = level
    node.hasNextSibling = hasNextSibling
    if (
        node instanceof ScalarNode && node.value.indexOf(query) !== -1
        || node instanceof PropertyNode && node.key.indexOf(query) !== -1
    ) {
        node.matched = true
        traverseTreeDownUp(node.parent, node => node.expanded = true)
    }
})

const scalarRenderer = (scalarNode) => {
    let val = `"${scalarNode.value.replace('"', '\\"')}"`
    if (scalarNode.matched) val = val.replace(query, `<span class="highlight">${query}</span>`)
    if (scalarNode.hasNextSibling) val += ','
    return scalarNode.parent instanceof ArrayNode ? `<li>${val}</li>` : val
}

const arrayRenderer = arrayNode => {
    const values = arrayNode.values.map(val => renderTree(val)).join('')
    const htmlClass = !arrayNode.expanded && arrayNode.level > 0 ? 'class="collapsed"' : ''
    return `<span>[</span><ul ${htmlClass}>${values}</ul><span>]</span>`
}

const objectRenderer = objectNode => {
    const props = objectNode.props.map(prop => {
        let val = renderTree(prop.value)
        if (prop.hasNextSibling) val += ','
        return `<li>${prop.key}: ${val}</li>`
    })
    const htmlClass = !objectNode.expanded && objectNode.level > 0 ? 'class="collapsed"' : ''
    const ret = `<span>{</span><ul ${htmlClass}>${props.join('')}</ul><span>}</span>`

    return objectNode.parent instanceof ArrayNode ? `<li>${ret}</li>` : ret
}

const renderTree = treeRenderer(scalarRenderer, arrayRenderer, objectRenderer)

console.log(renderTree(tree))
//console.log(inspect(tree, {showHidden: false, depth: null}))

